<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒãƒå…¬éŠ…åƒã¾ã§ã®è·é›¢</title>
  <style>
    body {
      background-color: yellow; /* èƒŒæ™¯è‰²ã‚’é»„è‰²ã«è¨­å®š */
      margin: 0; /* ä½™ç™½ã‚’ãªãã™ */
    }
    .container {
      display: flex;
      flex-direction: column; /* ç¸¦æ–¹å‘ã®ä¸¦ã³ */
      justify-content: center; /* æ°´å¹³æ–¹å‘ã®ä¸­å¤®æƒãˆ */
      align-items: center; /* å‚ç›´æ–¹å‘ã®ä¸­å¤®æƒãˆ */
      height: 80vh; /* ã‚³ãƒ³ãƒ†ãƒŠã®é«˜ã•ã‚’ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®é«˜ã•ã«è¨­å®š */
    }
    #check {
      font-size: 18pt;
      background-color: purple; /* ãƒœã‚¿ãƒ³ã®èƒŒæ™¯è‰²ã‚’ç´«ã«è¨­å®š */
      color: white; /* ãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆè‰²ã‚’ç™½ã«è¨­å®š */
      border: none; /* æ ç·šã‚’å‰Šé™¤ */
      padding: 10px 20px; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¨­å®š */
      border-radius: 5px; /* ãƒœã‚¿ãƒ³ã®è§’ã‚’ä¸¸ãã™ã‚‹ */
    }
    #check:hover {
      background-color: #7d00ff; /* ãƒ›ãƒãƒ¼æ™‚ã®ãƒœã‚¿ãƒ³ã®èƒŒæ™¯è‰²ã‚’å¤‰æ›´ */
    }
    .text {
      font-size: 24pt;
      color: black; /* ãƒ†ã‚­ã‚¹ãƒˆã®è‰²ã‚’é»’ã«è¨­å®š */
      margin-bottom: 18pt; /* ãƒœã‚¿ãƒ³ã¨ã®é–“ã®ãƒãƒ¼ã‚¸ãƒ³ */
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="text">ãƒãƒå…¬ã¾ã§ã®<br/>è·é›¢ã‚’æ¸¬ã‚‹<br/>ï¼ˆ10mä»¥å†…ã§OKï¼‰</div>
    <button id="check">å ´æ‰€ã‚’ãƒã‚§ãƒƒã‚¯ï¼</button>
    <div class="text"></div>
    <div class="text"><img src="landmark_hachikou.png" width="200"/></div>
    <div class="text"><a rel="nofollow" target="_blank" href="record.html"><strong>ğŸ’¾ç·¯åº¦çµŒåº¦ã®è¨˜éŒ²ã‚’ã™ã‚‹</strong></a></div>
   
  </div>

<!-- ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªè¦ç´ ã®å®šç¾©ã€‚ã“ã“ã§MP3ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¾ã™ -->
<audio id="myAudio" preload="auto">
  <source src="sample-voice.mp3" type="audio/mpeg">
  ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯audioè¦ç´ ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚
</audio>

<script>
  // ãƒšãƒ¼ã‚¸ãŒå®Œå…¨ã«èª­ã¿è¾¼ã¾ã‚ŒãŸå¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹é–¢æ•°
  function audioplay() {
      // ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚’å†ç”Ÿã™ã‚‹
          var audio = document.getElementById('myAudio');
          audio.play();
  };
</script>


<script type="text/javascript">

document.addEventListener('DOMContentLoaded', function() {
  const checkButton = document.getElementById('check');

  // ç‰¹å®šåœ°ç‚¹ã®ç·¯åº¦çµŒåº¦ï¼ˆä¾‹ï¼‰
const targetLatitude = 35.840768048134166;
const targetLongitude = 139.5874240273591;
let watchID = null; // ç›£è¦–IDã‚’ä¿æŒã™ã‚‹å¤‰æ•°

  // 2ç‚¹é–“ã®è·é›¢ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°ï¼ˆHaversineå…¬å¼ã‚’ä½¿ç”¨ï¼‰
  function calculateDistance(lat1, lon1, lat2, lon2) {
    const R = 6371e3; // åœ°çƒã®åŠå¾„ï¼ˆãƒ¡ãƒ¼ãƒˆãƒ«ï¼‰
    const rad = Math.PI / 180;
    const deltaLat = (lat2 - lat1) * rad;
    const deltaLon = (lon2 - lon1) * rad;
    const a = Math.sin(deltaLat / 2) * Math.sin(deltaLat / 2) +
              Math.cos(lat1 * rad) * Math.cos(lat2 * rad) *
              Math.sin(deltaLon / 2) * Math.sin(deltaLon / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c;
  }

  // ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
  checkButton.addEventListener('click', function() {

    // æ—¢å­˜ã®ç›£è¦–ãŒã‚ã‚Œã°åœæ­¢
    if (watchID !== null) {
      navigator.geolocation.clearWatch(watchID);
    }
    let count = 0; // ä½ç½®æƒ…å ±å–å¾—ã®å›æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
    let positions = []; // ä½ç½®æƒ…å ±ã‚’æ ¼ç´ã™ã‚‹é…åˆ—

    watchID = navigator.geolocation.watchPosition(function(position) {

      positions.push(position);

      // 5å›ã®ä½ç½®æƒ…å ±ã‚’å–å¾—ã—ãŸã‚‰
      if (positions.length === 5) {

        navigator.geolocation.clearWatch(watchID);

        // å¹³å‡ç·¯åº¦ã¨çµŒåº¦ã‚’è¨ˆç®—
        const userLat = positions.reduce((sum, p) => sum + p.coords.latitude, 0) / positions.length;
        const userLon = positions.reduce((sum, p) => sum + p.coords.longitude, 0) / positions.length;

      // ç‰¹å®šåœ°ç‚¹ã¨ã®è·é›¢ã‚’è¨ˆç®—
      const distance = calculateDistance(userLat, userLon, targetLatitude, targetLongitude);

      // è·é›¢ãŒ10mä»¥å†…ã§ã‚ã‚Œã°ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è¡¨ç¤º
      var gosa = (Math.round(distance * 10)/10);
      var moji = "èª¤å·®ï¼š"+gosa+"m";

      if (distance <= 10) {
        audioplay();alert('10mä»¥å†…:'+moji+'\n'+userLat+' : '+userLon);
        navigator.geolocation.clearWatch(watchID);
      }else{
        alert('é›¢ã‚Œã¦ã‚‹:'+moji+'\n'+userLat+' : '+userLon);
        navigator.geolocation.clearWatch(watchID);
      }

      }


    }, function(error) {
      alert('ä½ç½®æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
    }, {
      enableHighAccuracy: true
    });


  });
});


</script>

</body>
</html>
