## 2023年12月24日

緯度経度の記録用ページを追加しました。10回計測して、中央値を最後に表示します。

現場にいって、実際のスマホでスポットの位置情報を計測して、メインプログラムに使いましょう。

![20231224194232](https://github.com/kagua/Open-Spot-AR/assets/631291/5153e9c9-6023-420f-b7ef-56823ec6f63d)

せっかくGPS記録用のページを作りましたので、他の地図アプリと比較してみました。

- what3words
- GoogleMaps

上図の場所で測ったときは、**GoogleMpas＞what3words＞OpenSpotAR**、の順で精度がよい感じです。他の場所でもだいたいこんな感じでした。

## 2023年12月23日

![image](https://github.com/kagua/Open-Spot-AR/assets/631291/f1899899-9aaa-441a-8801-ee5b0427cb22)

前述の記事にあるように、JavaScriptの位置情報取得のメソッドを、getCurrentPositionからwatchPositionにしてみたら、精度が向上しました。

getCurrentPositionで、誤差20m～50mだったものが、watchPositionですと、使い方は難しいものの、誤差は10m程度にあがりました。

というわけで、ようやく次のフェーズにいけそうです。記事著者に感謝です。

詳しくはブログに書きました。

JavaScriptで位置情報がズレるのを直した

https://www.kagua.biz/tool/javascript-tool/20231225a1.html

## 2023年12月22日

![image](https://github.com/kagua/Open-Spot-AR/assets/631291/b19398e6-2bce-4ee6-aff9-19250c862c45)

下３つの行が、室内で取得した位置情報です。誤差が10m以内で、非常に優秀です。

これを信じて、Open-Spot-AR の公開をしましたが、その上の行が屋外です。

屋外は、①を中心に西北東南2mに移動して、位置取得したのですが、もうすごい誤差です。

同一地点で計測しても、10m以上のばらつきがあります。

ブラウザでの位置情報取得が、ここまで精度が微妙だったとは。Googleマップがどれだけ優秀かがわかりました。

室内が異常値だったのか。

いや、自宅の前でも数mの誤差だったので、なぜだ・・・。

地域活性化イベントでこの精度だったら、大騒ぎだ。

あと、ブラウザで位置情報を取得していたら、何回か取得したら、まったく取得できなくなりました。

ブラウザ再起動ではダメで、Googleマップ起動でGPSを使って、またブラウザ再起動で正常になりました。

ブラウザが何か悪さをしているのかな・・・。調べないと。

## メソッドを変更してみる

getCurrentPosition は精度が出ないので watchPosition を使う。 - freefielder.jp

https://freefielder.jp/blog/2011/11/getcurrentposition-watchpositi.html

これをやってみる。どうやら、GPSを常にチェックしに行くメソッドっぽく、計測したら計測を止める処理も入れないといけないのだが、とりあえず5回計測してその平均で試してみたら、自宅で試したぶんには良さげだったので、明日リベンジ。

続く。
